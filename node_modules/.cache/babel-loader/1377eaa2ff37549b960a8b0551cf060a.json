{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\colis\\\\Desktop\\\\access-to-justice\\\\src\\\\App.js\",\n    _s = $RefreshSig$();\n\nimport \"semantic-ui-css/semantic.min.css\";\nimport AdvocateDBoard from \"./dashboards/AdvocateDBoard\";\nimport A2JDBoard from \"./dashboards/DBoardTemplate\";\nimport LoginPage from \"./login/LoginPage\";\nimport { useLocation, Switch, Route } from \"react-router-dom\";\nimport PrivateRoute from \"./private-route\";\nimport { useEffect, useState } from \"react\";\nimport { useAuth0 } from \"@auth0/auth0-react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  const {\n    user,\n    getAccessTokenSilently\n  } = useAuth0();\n  const domain = process.env.REACT_APP_AUTH0_DOMAIN;\n  const [role, setRole] = useState({});\n  useEffect(() => {\n    const getUserMetadata = async () => {\n      try {\n        getAccessTokenSilently({\n          audience: `https://${domain}/api/v2/`,\n          scope: \"read:current_user\"\n        }).then(accessToken => {\n          const userDetailsByIdUrl = `https://${domain}/api/v2/users/${user.sub}`;\n          fetch(userDetailsByIdUrl, {\n            headers: {\n              Authorization: `Bearer ${accessToken}`\n            }\n          }).then(metadataResponse => {\n            metadataResponse.json().then(result => {\n              setRole(result.app_metadata.role);\n            });\n          });\n        }).catch(e => {\n          console.log(e);\n        });\n      } catch (e) {\n        console.log(e);\n      }\n    };\n\n    if (user) {\n      getUserMetadata();\n    }\n  }, [domain, getAccessTokenSilently, user, role]);\n\n  const redirectToAdvocate = pathname => {\n    if (role === \"advocate\") {\n      if (pathname !== \"advocate\") {\n        window.location.href = `${window.location.origin}/advocate`;\n      }\n    }\n  };\n\n  const location = useLocation();\n  useEffect(() => {\n    console.log(location.pathname);\n    console.log(role);\n    redirectToAdvocate(location.pathname);\n  }, [location, role]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: /*#__PURE__*/_jsxDEV(Switch, {\n      children: [/*#__PURE__*/_jsxDEV(PrivateRoute, {\n        exact: true,\n        path: \"/advocate\",\n        component: AdvocateDBoard\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(PrivateRoute, {\n        exact: true,\n        path: \"/a2j\",\n        component: A2JDBoard\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Route, {\n        exact: true,\n        path: \"/\",\n        component: LoginPage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"6Q+AvFHV68/D3SADGrOe8l/mRZY=\", false, function () {\n  return [useAuth0, useLocation];\n});\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["C:/Users/colis/Desktop/access-to-justice/src/App.js"],"names":["AdvocateDBoard","A2JDBoard","LoginPage","useLocation","Switch","Route","PrivateRoute","useEffect","useState","useAuth0","App","user","getAccessTokenSilently","domain","process","env","REACT_APP_AUTH0_DOMAIN","role","setRole","getUserMetadata","audience","scope","then","accessToken","userDetailsByIdUrl","sub","fetch","headers","Authorization","metadataResponse","json","result","app_metadata","catch","e","console","log","redirectToAdvocate","pathname","window","location","href","origin"],"mappings":"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","sourcesContent":["import \"semantic-ui-css/semantic.min.css\";\r\nimport AdvocateDBoard from \"./dashboards/AdvocateDBoard\";\r\nimport A2JDBoard from \"./dashboards/DBoardTemplate\";\r\nimport LoginPage from \"./login/LoginPage\";\r\nimport { useLocation, Switch, Route } from \"react-router-dom\";\r\nimport PrivateRoute from \"./private-route\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useAuth0 } from \"@auth0/auth0-react\";\r\n\r\nfunction App() {\r\n  const { user, getAccessTokenSilently } = useAuth0();\r\n\r\n  const domain = process.env.REACT_APP_AUTH0_DOMAIN;\r\n\r\n  const [role, setRole] = useState({});\r\n\r\n  useEffect(() => {\r\n    const getUserMetadata = async () => {\r\n      try {\r\n        getAccessTokenSilently({\r\n          audience: `https://${domain}/api/v2/`,\r\n          scope: \"read:current_user\",\r\n        })\r\n          .then((accessToken) => {\r\n            const userDetailsByIdUrl = `https://${domain}/api/v2/users/${user.sub}`;\r\n\r\n            fetch(userDetailsByIdUrl, {\r\n              headers: {\r\n                Authorization: `Bearer ${accessToken}`,\r\n              },\r\n            }).then((metadataResponse) => {\r\n              metadataResponse.json().then((result) => {\r\n                setRole(result.app_metadata.role);\r\n              });\r\n            });\r\n          })\r\n          .catch((e) => {\r\n            console.log(e);\r\n          });\r\n      } catch (e) {\r\n        console.log(e);\r\n      }\r\n    };\r\n    if (user) {\r\n      getUserMetadata();\r\n    }\r\n  }, [domain, getAccessTokenSilently, user, role]);\r\n\r\n  const redirectToAdvocate = (pathname) => {\r\n    if (role === \"advocate\") {\r\n      if (pathname !== \"advocate\") {\r\n        window.location.href = `${window.location.origin}/advocate`;\r\n      }\r\n    }\r\n  };\r\n\r\n  const location = useLocation();\r\n\r\n  useEffect(() => {\r\n    console.log(location.pathname);\r\n    console.log(role);\r\n    redirectToAdvocate(location.pathname);\r\n  }, [location, role]);\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <Switch>\r\n        <PrivateRoute exact path=\"/advocate\" component={AdvocateDBoard} />\r\n        <PrivateRoute exact path=\"/a2j\" component={A2JDBoard} />\r\n        <Route exact path=\"/\" component={LoginPage} />\r\n      </Switch>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}